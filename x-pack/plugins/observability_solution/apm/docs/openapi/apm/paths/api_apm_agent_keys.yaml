post:
  summary: Create an APM agent key
  description: >
    Create an APM agent API key.

    Specify API key privileges in the request body at creation time.


    You must have at least the `manage_own_api_key` cluster privilege and the
    APM application-level privileges that it wishes to grant.
  operationId: createAgentKey
  tags:
    - APM agent keys
  requestBody:
    required: true
    content:
      application/json:
        schema:
          type: object
          properties:
            name:
              description: The name of the APM agent key.
              type: string
              example: my-new-apm-key
            privileges:
              description: >
                APM agent key privileges. It can take one or more of the
                following values:


                * `event:write`: Required for ingesting APM agent events.

                * `config_agent:read`: Required for APM agents to read agent
                configuration remotely.
              type: array
              items:
                type: string
                enum:
                  - event:write
                  - config_agent:read
              example:
                - event:write
                - config_agent:read
          required:
            - name
            - privileges
  responses:
    '200':
      description: The agent key was created successfully.
      content:
        application/json:
          schema:
            type: object
            properties:
              api_key:
                type: string
                example: PjGloCGOTzaZr8ilUPvkjA
              expiration:
                type: integer
                format: int64
              id:
                type: string
                example: 3DCLmn0B3ZMhLUa7WBG9
              name:
                type: string
                example: my-new-apm-key
              encoded:
                type: string
                example: M0RDTG1uMEIzWk1oTFVhN1dCRzk6UGpHbG9DR09UemFacjhpbFVQdmtqQQ
